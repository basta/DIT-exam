---
id: ssu_batch6_004
course: Statistical Machine Learning
tags: [markov-chain, expected-value, marginal-probability, algorithm]
difficulty: 4
type: derivation
status: to_learn
---

# Question
(4p) Consider a homogeneous Markov model for sequences $s = (s_1, \dots, s_n)$ with elements from a finite set $K$. Its joint distribution is given by
$$ p(s) = p(s_1) \prod_{i=2}^n p(s_i \mid s_{i-1}), $$
where $p(s_1=k)$ is the marginal distribution for the first element of the sequence and $p(s_i=k \mid s_{i-1}=k')$ is the matrix of transition probabilities. Given a state $k^* \in K$, we want to know its expected number of occurrences in a sequence generated by the model. Give an algorithm for computing this expectation.
*Hint*: Use the fact that the expected value of a sum of random variables is equal to the sum of their expected values.

---
# Solution
We want to compute the expected counts of state $k^*$ in the sequence.
Let $N(k^*) = \sum_{i=1}^n \mathbb{I}[s_i = k^*]$.
We need $\mathbb{E}[N(k^*)]$.
Using linearity of expectation:
$$ \mathbb{E}[N(k^*)] = \mathbb{E} \left[ \sum_{i=1}^n \mathbb{I}[s_i = k^*] \right] = \sum_{i=1}^n \mathbb{E}[\mathbb{I}[s_i = k^*]] $$
$$ \mathbb{E}[\mathbb{I}[s_i = k^*]] = P(s_i = k^*) $$
So the problem reduces to computing the marginal probabilities $P(s_i = k^*)$ for all $i = 1, \dots, n$ and summing them up.

**Algorithm:**
1.  **Initialize:** $P(s_1 = k) = p(s_1 = k)$ (Given).
2.  **Forward Pass:** For $i = 2$ to $n$:
    Compute marginals for step $i$:
    $$ P(s_i = k) = \sum_{k' \in K} P(s_i = k \mid s_{i-1} = k') P(s_{i-1} = k') $$
    (This is simply vector-matrix multiplication: $\mathbf{p}_i = \mathbf{p}_{i-1} \mathbf{A}$, where $\mathbf{A}$ is transition matrix).
3.  **Summation:**
    $$ \mathbb{E}[N(k^*)] = \sum_{i=1}^n P(s_i = k^*) $$

## Related Concepts
- [[markov-chain]]
- [[expected-value]]
- [[marginal-probability]]
